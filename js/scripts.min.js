$(document).ready(function(){function s(s){var e,t=s.toString().length;return e=0==t?"00":1==t?"0"+s:2==t?s:s.replace(/^0+/,"")}function e(s){var e,t=s.toString().length;return e=0==t?"000":1==t?"00"+s:2==t?"0"+s:3==t?s:s.replace(/^0+/,"")}$(".row-number").each(function(s){$(this).html(s+1)});var t='<div class="row sub"><div class="col-md-1"><div class="row"><div class="col-md-12 row-controls"><i class="fa fa-times row-control" aria-hidden="true"></i><i class="fa fa-bars row-control" aria-hidden="true"></i></div></div><div class="row"><div class="col-md-12 row-number"></div></div></div><div class="col-md-2"><div class="row"><div class="col-md-12 label-wrapper">Start Time:</div></div><div class="row"><div class="col-md-4 number-wrapper"><input class="start-min number" max="59" placeholder="mm"></div><div class="col-md-4 number-wrapper"><input class="start-sec number" max="59" placeholder="ss"></div><div class="col-md-4 number-wrapper"><input class="start-msec number" max="999" placeholder="mms"></div></div></div><div class="col-md-2"><div class="row"><div class="col-md-12 label-wrapper">End Time:</div></div><div class="row"><div class="col-md-4 number-wrapper"><input class="end-min number" max="59" placeholder="mm"></div><div class="col-md-4 number-wrapper"><input class="end-sec number" max="59" placeholder="ss"></div><div class="col-md-4 number-wrapper"><input class="end-msec number" max="999" placeholder="mms"></div></div></div><div class="col-md-6"><div class="row"><div class="col-md-12 label-wrapper">Subtitle:</div></div><div class="row"><div class="col-md-12 subtitle-wrapper"><input class="subtitle-text" type="text"></div></div></div><div class="col-md-1"><div class="row"><div class="col-md-12 label-wrapper">Style:</div></div><div class="row"><div class="col-md-12 style-wrapper"><div class="style-select"><div class="style-selected options-hidden"><span data-style="none">None<i class="fa fa-caret-down" aria-hidden="true"></i></span></div><div class="style-select-option style-select-option-hidden"><span data-style="none">None</span></div><div class="style-select-option style-select-option-hidden"><span data-style="bold"><i class="fa fa-bold" aria-hidden="true"></i></span></div><div class="style-select-option style-select-option-hidden"><span data-style="italic"><i class="fa fa-italic" aria-hidden="true"></i></span></div><div class="style-select-option style-select-option-hidden"><span data-style="underline"><i class="fa fa-underline" aria-hidden="true"></i></span></div></div></div></div></div></div>';$(document).on("keyup","input.number",function(){var s=Number($(this).attr("max")),e=$(this).val(),t=Number($(this).val());(t>s||isNaN(t))&&(e=e.slice(0,-1),$(this).val(e))}),$(document).on("keyup","input",function(){$("#downloadlink").css("display","none")}),$(".control-add").click(function(){$(".sub-first").removeClass("sub-no-sort"),$(".row-control").removeClass("row-control-disable");Number($(".row-number").each(function(){}).length)+1;$("#subs").append(t),$(".row-number").each(function(s){$(this).html(s+1)})}),$(".control-create").click(function(){$("#output").html("");var t=$(".sub").length;$(".sub").each(function(i){function l(s){var e={start:"",end:""};return"bold"==s?(e.start="&lt;b&gt;",e.end="&lt;/b&gt;"):"italic"==s?(e.start="&lt;i&gt;",e.end="&lt;/i&gt;"):"underline"==s&&(e.start="&lt;u&gt;",e.end="&lt;/u&gt;"),e}var n=i+1,a=s($(this).find(".start-min").val()),d=s($(this).find(".start-sec").val()),o=e($(this).find(".start-msec").val()),c=s($(this).find(".end-min").val()),r=s($(this).find(".end-sec").val()),p=e($(this).find(".end-msec").val()),v=$(this).find(".subtitle-text").val();console.log(v);var u=$(this).find(".style-selected span").attr("data-style"),m=l(u).start,h=l(u).end;$("#output").append(n+"&#13;00:"+a+":"+d+","+o+" --> 00:"+c+":"+r+","+p+"&#13;"+m+v+h),t-1>i&&$("#output").append("&#13;&#13;")})}),$("#subs").sortable({cancel:".sub-no-sort",handle:".fa-bars",stop:function(){$(".sub").removeClass("sub-first"),$(".row-number").each(function(s){$(this).html(s+1)})}}),$(document).on("click",".fa-times",function(){$(this).closest(".sub").remove(),$(".row-number").each(function(s){$(this).html(s+1)})}),function(){var s=null,e=function(e){var t=new Blob([e],{type:"text/plain"});return null!==s&&window.URL.revokeObjectURL(s),s=window.URL.createObjectURL(t)},t=document.getElementById("create"),i=document.getElementById("output");t.addEventListener("click",function(){var s=document.getElementById("downloadlink");s.href=e(i.value),s.style.display="block"},!1)}(),$(document).on("click",".style-selected",function(){$(this).hasClass("options-hidden")?($(this).removeClass("options-hidden").addClass("options-shown"),$(this).parent().find(".style-select-option").show(),$(".style-select-option").removeClass("style-select-option-hidden").addClass("style-select-option-shown")):$(this).hasClass("options-shown")&&($(".style-select").show(),$(this).removeClass("options-shown").addClass("options-hidden"),$(".style-select-option").hide(),$(".style-select-option").removeClass("style-select-option-shown").addClass("style-select-option-hidden"))}),$(document).on("click",".style-select-option",function(){var s=$(this).html(),e=$(this).text();$(this).parent().find(".style-selected").html(s+'<i class="fa fa-caret-down" aria-hidden="true"></i>'),"None"==e.trim()?($(this).parent().find(".style-selected").css({"padding-top":"2px","padding-bottom":"2px"}),$(this).parent().find(".style-selected .fa-caret-down").css({"margin-top":"3px"})):($(this).parent().find(".style-selected").css({"padding-top":"5px","padding-bottom":"5px"}),$(this).parent().find(".style-selected .fa-caret-down").css({"margin-top":"0px"})),$(".style-selected").removeClass("options-shown").addClass("options-hidden"),$(".style-select-option").hide(),$(".style-select-option").removeClass("style-select-option-shown").addClass("style-select-option-hidden")})});